{"ast":null,"code":"var _jsxFileName = \"/Users/achilles/Documents/GitHub/Find-Location-React-Redux/src/views/components/location-acquire.js\",\n    _s = $RefreshSig$();\n\nimport { connect } from \"react-redux\";\nimport { updateList } from \"../../redux/reducer\";\nimport { useState, useRef } from \"react\";\nimport axios from \"axios\";\nimport { Button, Input, Card, Col, Row } from \"antd\";\nimport styles from \"../scss/location-acquire.module.scss\";\nimport Map from \"./Map\";\nimport { APIKey, initialLocation, mapStyle } from \"../../config/ConfigurationData\";\nimport { Loader } from \"@googlemaps/js-api-loader\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst google = window.google; //Loading google map using googlemaps js-api-loader\n\nconst GoogleMapAPI = new Loader({\n  apiKey: APIKey,\n  language: \"English\"\n}); //Containers for instances created by google built-in constructors\n\nlet GoogleMap, Marker, Geocoder, MyInfoWindow;\n\nfunction LocationAcquire(props) {\n  _s();\n\n  const {\n    Search\n  } = Input;\n  const [userLocation, setUserLocation] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [timeZone, setTimeZone] = useState(\"\");\n  const [localTime, setLocalTime] = useState(\"\");\n  const searchRef = useRef(null);\n\n  function getLocation() {\n    setErrorMessage(\"\");\n\n    if (navigator.geolocation) {\n      //Get user location from browser\n      navigator.geolocation.getCurrentPosition(showPosition, showError);\n    } else {\n      setErrorMessage(\"Geolocation is not supported by this browser.\");\n    } //clear input content after searching\n\n\n    searchRef.current.setState({\n      value: \"\"\n    });\n  }\n\n  function showPosition(position) {\n    //Requesting data from google map api\n    GoogleMapAPI.load().then(() => {\n      //Initialize the map with arguments\n      GoogleMap = new window.google.maps.Map(document.getElementById(\"map\"), {\n        center: initialLocation,\n        zoom: 15\n      }); //Add a marker at initial location\n\n      Marker = new window.google.maps.Marker({\n        position: this.state.markerPosition,\n        map: GoogleMap\n      });\n      Marker.addListener(\"click\", () => {\n        MyInfoWindow.open(GoogleMap, Marker);\n      });\n      Geocoder = new window.google.maps.Geocoder();\n      MyInfoWindow = new window.google.maps.InfoWindow({\n        content: \"My Home: 70 Forest Manor Rd, North York, ON M2J 1G2\"\n      });\n      MyInfoWindow.open(GoogleMap, Marker);\n    }); // const Geocoder = new google.maps.Geocoder();\n    //Get latitude and longitude\n\n    const lat = position.coords.latitude;\n    const lng = position.coords.longitude;\n    const latlng = {\n      lat,\n      lng\n    };\n    console.log(\"Latitude: \" + lat + \" Longitude: \" + lng);\n    Geocoder.geocode({\n      location: latlng\n    }).then(response => {\n      if (response.results[0]) {\n        //Get address from latitude and longitude\n        const address = response.results[0].formatted_address;\n        const curLength = props.list.length;\n        const key = curLength !== 0 ? props.list[curLength - 1].key + 1 : 1;\n        const userLocationObj = {\n          key,\n          address,\n          lat,\n          lng\n        };\n        props.updateList([userLocationObj, ...props.list]); //latest is first\n\n        setUserLocation(address); //Get time zone and local time from latitude and longitude\n\n        getTimeZoneLocalTime(lat, lng);\n      } else {\n        setErrorMessage(\"No results found\");\n      }\n    }).catch(e => setErrorMessage(\"Geocoder failed due to: \" + e));\n  }\n\n  function showError(error) {\n    switch (error.code) {\n      case error.PERMISSION_DENIED:\n        setErrorMessage(\"User denied the request for Geolocation.\");\n        break;\n\n      case error.POSITION_UNAVAILABLE:\n        setErrorMessage(\"Location information is unavailable.\");\n        break;\n\n      case error.TIMEOUT:\n        setErrorMessage(\"The request to get user location timed out.\");\n        break;\n\n      default:\n        setErrorMessage(\"An unknown error occurred.\");\n        break;\n    }\n  }\n\n  async function getTimeZoneLocalTime(lat, lng) {\n    try {\n      var _resData$data, _resData$data2;\n\n      const resData = await axios({\n        url: \"http://api.timezonedb.com/v2.1/get-time-zone?key=SQL380MLF2C9&format=json&by=position&lat=\" + lat + \"&lng=\" + lng,\n        method: \"GET\"\n      });\n      console.log(\"getTimeZoneLocalTime Get resData: \", resData);\n      setTimeZone(resData === null || resData === void 0 ? void 0 : (_resData$data = resData.data) === null || _resData$data === void 0 ? void 0 : _resData$data.zoneName);\n      setLocalTime(resData === null || resData === void 0 ? void 0 : (_resData$data2 = resData.data) === null || _resData$data2 === void 0 ? void 0 : _resData$data2.formatted);\n    } catch (er) {\n      setErrorMessage(\"Error occurred to get time zone and local time from http://api.timezonedb.com/v2.1/get-time-zone\");\n    }\n  }\n\n  const onSearch = value => {\n    setErrorMessage(\"\");\n\n    if (value === \"\") {\n      console.log(\"onSearch: \", value);\n      setErrorMessage(\"Please input location name.\");\n      return;\n    } //Requesting data from google map api\n\n\n    GoogleMapAPI.load().then(() => {\n      //Initialize the map with arguments\n      GoogleMap = new window.google.maps.Map(document.getElementById(\"map\"), {\n        center: initialLocation,\n        zoom: 15\n      }); //Add a marker at initial location\n\n      Marker = new window.google.maps.Marker({\n        position: this.state.markerPosition,\n        map: GoogleMap\n      });\n      Marker.addListener(\"click\", () => {\n        MyInfoWindow.open(GoogleMap, Marker);\n      });\n      Geocoder = new window.google.maps.Geocoder();\n      MyInfoWindow = new window.google.maps.InfoWindow({\n        content: \"My Home: 70 Forest Manor Rd, North York, ON M2J 1G2\"\n      });\n      MyInfoWindow.open(GoogleMap, Marker); //Get latitude and longitude from address\n\n      Geocoder.geocode({\n        address: value\n      }).then(({\n        results\n      }) => {\n        const lat = results[0].geometry.location.lat();\n        const lng = results[0].geometry.location.lng();\n        const curLength = props.list.length;\n        const key = curLength !== 0 ? props.list[curLength - 1].key + 1 : 1;\n        const userLocationObj = {\n          key,\n          address: value,\n          lat,\n          lng\n        };\n        props.updateList([userLocationObj, ...props.list]); //latest is first\n\n        setUserLocation(value); //address\n        //Get time zone and local time from latitude and longitude\n\n        getTimeZoneLocalTime(lat, lng); //clear input content after searching\n\n        searchRef.current.setState({\n          value: \"\"\n        });\n      }).catch(e => setErrorMessage(\"Geocoder failed due to: \" + e));\n    }); // const Geocoder = new google.maps.Geocoder();\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles[\"location-acquire-container\"],\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"location-acquire\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"location-acquire-btn\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          type: \"info\",\n          size: \"large\",\n          block: true,\n          onClick: getLocation,\n          children: \"Get Your Current Location\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"location-acquire-result\",\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          gutter: 12,\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            span: 8,\n            children: /*#__PURE__*/_jsxDEV(Card, {\n              title: \"Location\",\n              bordered: false,\n              children: userLocation\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 8,\n            children: /*#__PURE__*/_jsxDEV(Card, {\n              title: \"Time Zone\",\n              bordered: false,\n              children: timeZone\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 8,\n            children: /*#__PURE__*/_jsxDEV(Card, {\n              title: \"Local Time\",\n              bordered: false,\n              children: localTime\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"location-acquire-input\",\n        children: [/*#__PURE__*/_jsxDEV(Search, {\n          ref: searchRef,\n          placeholder: \"Please input location name\",\n          enterButton: \"Search\",\n          size: \"large\",\n          onSearch: onSearch\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"location-acquire-input-error\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: errorMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 208,\n    columnNumber: 5\n  }, this);\n}\n\n_s(LocationAcquire, \"xjf2J6L+jORQ5tr7PTKaCHqFDxY=\");\n\n_c = LocationAcquire;\nexport default connect(state => {\n  const {\n    list\n  } = state;\n  return {\n    list\n  };\n}, {\n  updateList\n})(LocationAcquire);\n\nvar _c;\n\n$RefreshReg$(_c, \"LocationAcquire\");","map":{"version":3,"sources":["/Users/achilles/Documents/GitHub/Find-Location-React-Redux/src/views/components/location-acquire.js"],"names":["connect","updateList","useState","useRef","axios","Button","Input","Card","Col","Row","styles","Map","APIKey","initialLocation","mapStyle","Loader","google","window","GoogleMapAPI","apiKey","language","GoogleMap","Marker","Geocoder","MyInfoWindow","LocationAcquire","props","Search","userLocation","setUserLocation","errorMessage","setErrorMessage","timeZone","setTimeZone","localTime","setLocalTime","searchRef","getLocation","navigator","geolocation","getCurrentPosition","showPosition","showError","current","setState","value","position","load","then","maps","document","getElementById","center","zoom","state","markerPosition","map","addListener","open","InfoWindow","content","lat","coords","latitude","lng","longitude","latlng","console","log","geocode","location","response","results","address","formatted_address","curLength","list","length","key","userLocationObj","getTimeZoneLocalTime","catch","e","error","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","resData","url","method","data","zoneName","formatted","er","onSearch","geometry"],"mappings":"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","sourcesContent":["import { connect } from \"react-redux\";\nimport { updateList } from \"../../redux/reducer\";\nimport { useState, useRef } from \"react\";\nimport axios from \"axios\";\nimport { Button, Input, Card, Col, Row } from \"antd\";\nimport styles from \"../scss/location-acquire.module.scss\";\n\nimport Map from \"./Map\";\nimport { APIKey, initialLocation, mapStyle } from \"../../config/ConfigurationData\";\nimport { Loader } from \"@googlemaps/js-api-loader\";\n\nconst google = window.google;\n\n//Loading google map using googlemaps js-api-loader\nconst GoogleMapAPI = new Loader({\n  apiKey: APIKey,\n  language: \"English\",\n});\n\n//Containers for instances created by google built-in constructors\nlet GoogleMap, Marker, Geocoder, MyInfoWindow;\n\nfunction LocationAcquire(props) {\n  const { Search } = Input;\n  const [userLocation, setUserLocation] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [timeZone, setTimeZone] = useState(\"\");\n  const [localTime, setLocalTime] = useState(\"\");\n  const searchRef = useRef(null);\n\n  function getLocation() {\n    setErrorMessage(\"\");\n\n    if (navigator.geolocation) {\n      //Get user location from browser\n      navigator.geolocation.getCurrentPosition(showPosition, showError);\n    } else {\n      setErrorMessage(\"Geolocation is not supported by this browser.\");\n    }\n\n    //clear input content after searching\n    searchRef.current.setState({ value: \"\" });\n  }\n\n\n  function showPosition(position) {\n\n    //Requesting data from google map api\n    GoogleMapAPI.load().then(() => {\n\n      //Initialize the map with arguments\n      GoogleMap = new window.google.maps.Map(document.getElementById(\"map\"), {\n        center: initialLocation,\n        zoom: 15,\n      });\n\n      //Add a marker at initial location\n      Marker = new window.google.maps.Marker({\n        position: this.state.markerPosition,\n        map: GoogleMap,\n      });\n\n      Marker.addListener(\"click\", () => {\n        MyInfoWindow.open(GoogleMap, Marker);\n      });\n\n      Geocoder = new window.google.maps.Geocoder();\n      MyInfoWindow = new window.google.maps.InfoWindow({\n        content: \"My Home: 70 Forest Manor Rd, North York, ON M2J 1G2\",\n      });\n\n      MyInfoWindow.open(GoogleMap, Marker);\n    });\n\n    // const Geocoder = new google.maps.Geocoder();\n\n    //Get latitude and longitude\n    const lat = position.coords.latitude;\n    const lng = position.coords.longitude;\n    const latlng = { lat, lng };\n    console.log(\"Latitude: \" + lat + \" Longitude: \" + lng);\n\n    Geocoder\n      .geocode({ location: latlng })\n      .then((response) => {\n        if (response.results[0]) {\n          //Get address from latitude and longitude\n          const address = response.results[0].formatted_address;\n          const curLength = props.list.length;\n          const key = curLength !== 0 ? props.list[curLength - 1].key + 1 : 1;\n\n          const userLocationObj = { key, address, lat, lng };\n\n          props.updateList([userLocationObj, ...props.list]); //latest is first\n          setUserLocation(address);\n\n          //Get time zone and local time from latitude and longitude\n          getTimeZoneLocalTime(lat, lng);\n        } else {\n          setErrorMessage(\"No results found\");\n        }\n      })\n      .catch((e) => setErrorMessage(\"Geocoder failed due to: \" + e));\n  }\n\n  function showError(error) {\n    switch (error.code) {\n      case error.PERMISSION_DENIED:\n        setErrorMessage(\"User denied the request for Geolocation.\");\n        break;\n      case error.POSITION_UNAVAILABLE:\n        setErrorMessage(\"Location information is unavailable.\");\n        break;\n      case error.TIMEOUT:\n        setErrorMessage(\"The request to get user location timed out.\");\n        break;\n      default:\n        setErrorMessage(\"An unknown error occurred.\");\n        break;\n    }\n  }\n\n  async function getTimeZoneLocalTime(lat, lng) {\n    try {\n      const resData = await axios({\n        url:\n          \"http://api.timezonedb.com/v2.1/get-time-zone?key=SQL380MLF2C9&format=json&by=position&lat=\" +\n          lat +\n          \"&lng=\" +\n          lng,\n        method: \"GET\",\n      });\n      console.log(\"getTimeZoneLocalTime Get resData: \", resData);\n\n      setTimeZone(resData?.data?.zoneName);\n      setLocalTime(resData?.data?.formatted);\n    } catch (er) {\n      setErrorMessage(\n        \"Error occurred to get time zone and local time from http://api.timezonedb.com/v2.1/get-time-zone\"\n      );\n    }\n  }\n\n  const onSearch = (value) => {\n    setErrorMessage(\"\");\n\n    if (value === \"\") {\n      console.log(\"onSearch: \", value);\n      setErrorMessage(\"Please input location name.\");\n      return;\n    }\n\n    //Requesting data from google map api\n    GoogleMapAPI.load().then(() => {\n\n      //Initialize the map with arguments\n      GoogleMap = new window.google.maps.Map(document.getElementById(\"map\"), {\n        center: initialLocation,\n        zoom: 15,\n      });\n\n      //Add a marker at initial location\n      Marker = new window.google.maps.Marker({\n        position: this.state.markerPosition,\n        map: GoogleMap,\n      });\n\n      Marker.addListener(\"click\", () => {\n        MyInfoWindow.open(GoogleMap, Marker);\n      });\n\n      Geocoder = new window.google.maps.Geocoder();\n      MyInfoWindow = new window.google.maps.InfoWindow({\n        content: \"My Home: 70 Forest Manor Rd, North York, ON M2J 1G2\",\n      });\n\n      MyInfoWindow.open(GoogleMap, Marker);\n\n      //Get latitude and longitude from address\n    Geocoder.geocode({ address: value })\n    .then(({ results }) => {\n      const lat = results[0].geometry.location.lat();\n      const lng = results[0].geometry.location.lng();\n\n      const curLength = props.list.length;\n      const key = curLength !== 0 ? props.list[curLength - 1].key + 1 : 1;\n      const userLocationObj = { key, address: value, lat, lng };\n\n      props.updateList([userLocationObj, ...props.list]); //latest is first\n      setUserLocation(value); //address\n\n      //Get time zone and local time from latitude and longitude\n      getTimeZoneLocalTime(lat, lng);\n\n      //clear input content after searching\n      searchRef.current.setState({ value: \"\" });\n    })\n    .catch((e) => setErrorMessage(\"Geocoder failed due to: \" + e));\n    \n    });\n\n    // const Geocoder = new google.maps.Geocoder();\n\n    \n  };\n\n  return (\n    <div className={styles[\"location-acquire-container\"]}>\n      <div className=\"location-acquire\">\n\n        <div className=\"location-acquire-btn\">\n          <Button type=\"info\" size=\"large\" block onClick={getLocation}>\n            Get Your Current Location\n          </Button>\n        </div>\n\n        <div className=\"location-acquire-result\">\n          <Row gutter={12}>\n            <Col span={8}>\n              <Card title=\"Location\" bordered={false}>\n                {userLocation}\n              </Card>\n            </Col>\n            <Col span={8}>\n              <Card title=\"Time Zone\" bordered={false}>\n                {timeZone}\n              </Card>\n            </Col>\n            <Col span={8}>\n              <Card title=\"Local Time\" bordered={false}>\n                {localTime}\n              </Card>\n            </Col>\n          </Row>\n        </div>\n\n        <div className=\"location-acquire-input\">\n          <Search\n            ref={searchRef}\n            placeholder=\"Please input location name\"\n            enterButton=\"Search\"\n            size=\"large\"\n            onSearch={onSearch}\n          />\n          {errorMessage && (\n            <div className=\"location-acquire-input-error\">\n              <span>{errorMessage}</span>\n            </div>\n          )}\n        </div>\n        \n      </div>\n    </div>\n  );\n}\n\nexport default connect(\n  (state) => {\n    const { list } = state;\n    return { list };\n  },\n  { updateList }\n)(LocationAcquire);\n"]},"metadata":{},"sourceType":"module"}